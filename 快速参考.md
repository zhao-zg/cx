# 快速参考

## 🚀 快速开始

```powershell
# 1. 准备文档(按批次组织)
# resource/2025-秋季/听抄.docx, 经文.docx, 晨兴.doc
# resource/2025-夏季/听抄.doc, 经文.docx, 晨兴.doc

# 2. 激活虚拟环境
cd G:\project\go\cx
.venv\Scripts\Activate.ps1

# 3. 运行批量生成
python main.py

# 4. 查看结果
start output\2025-秋季\index.html
start output\2025-夏季\index.html
```

## 📁 支持的文档格式

| 文档类型 | 格式支持 | 自动检测 |
|---------|---------|---------|
| 听抄文档 | `.doc` / `.docx` | ✅ |
| 经文文档 | `.doc` / `.docx` | ✅ |
| 晨兴文档 | `.doc` / `.docx` | ✅ |

## ⚙️ 配置文件示例

```yaml
# config.yaml

title: "二〇二五年秋季国际长老及负责弟兄训练"
subtitle: "马太福音五至七章极重要的方面"
year: 2025
season: "秋季"

# 批量处理配置
resource_dir: "resource"  # 包含批次子文件夹的目录
output_dir: "output"      # 输出根目录
template_dir: "src/templates"
```

## 📁 批次目录结构

```
resource/
├── 2025-秋季/
│   ├── 听抄.docx
│   ├── 经文.docx
│   └── 晨兴.doc
├── 2025-夏季/
│   ├── 听抄.doc
│   ├── 经文.docx
│   └── 晨兴.doc
└── 2024-春季/
    ├── 听抄.docx
    ├── 经文.docx
    └── 晨兴.docx
```

输出会自动组织为:

```
output/
├── 2025-秋季/
│   ├── index.html
│   └── 1_dg.htm, 1_cv.htm, ...
├── 2025-夏季/
│   ├── index.html
│   └── ...
└── 2024-春季/
    └── ...
```

## 📱 生成的页面类型

每篇生成 7 个页面:

| 后缀 | 页面类型 | 说明 |
|-----|---------|------|
| `_dg.htm` | 大纲 | 概要摘要 |
| `_cv.htm` | 纲目 | 完整纲目结构 |
| `_sg.htm` | 诗歌 | 诗歌信息 |
| `_cx.htm` | 晨兴 | 每周晨兴内容(分页) |
| `_zs.htm` | 职事 | 职事信息摘录 |
| `_ts.htm` | 详情 | 详细说明 |
| `_h.htm` | 听抄 | 听抄内容 |

示例: 第1篇生成 `1_dg.htm`, `1_cv.htm`, `1_sg.htm` 等

## 🎨 移动端优化

- ✅ 移动优先响应式设计
- ✅ 44px 最小触摸目标
- ✅ 16px 基础字号
- ✅ 触摸友好的交互
- ✅ 系统原生字体

断点: 768px (移动端 < 768px, 桌面端 ≥ 768px)

## 📚 文档说明

| 文档 | 内容 |
|-----|------|
| `README.md` | 项目概述和基本用法 |
| `使用指南.md` | 详细使用说明 |
| `文档格式支持说明.md` | 文档格式详解 |
| `批量生成说明.md` | **批量处理详细说明** |
| `移动端优化说明.md` | 移动端优化详情 |
| `更新说明.md` | 版本更新记录 |
| `快速参考.md` | 本文档 |

## 🔧 常见问题

### Q: 如何更换文档?

A: 在 `resource/` 下创建新的批次文件夹,放入文档即可。

### Q: 支持混合使用 .doc 和 .docx 吗?

A: 完全支持!每个文档可以是不同格式。

### Q: 如何处理单个批次?

A: 临时移动其他批次文件夹,或删除 resource 下不需要的文件夹。

### Q: 晨兴文档是必需的吗?

A: 不是,如果没有晨兴文档,程序会跳过晨兴页面生成。

### Q: 如何查看批量生成结果?

A: 每个批次的输出在 `output/批次名称/` 目录下,都有独立的 index.html。

## 🛠️ 技术栈

| 组件 | 技术 |
|-----|------|
| 文档解析 | `python-docx` (`.docx`)<br>`pywin32` (`.doc`) |
| 模板引擎 | Jinja2 |
| 配置 | YAML |
| 前端 | HTML5 + CSS3 (移动优先) |
| 字体 | 系统原生字体栈 |

## ⚡ 性能提示

- 推荐使用 `.docx` 格式 (解析更快)
- `.doc` 需要 Microsoft Word (仅 Windows)
- 首次运行较慢(COM 初始化),后续运行正常

## 📊 输出统计

每个批次生成:
- 1 个首页 (`index.html`)
- N × 7 个内容页 (N = 篇章数)

示例: 
- 2个批次,每批次9篇
- 2025-秋季: 1 + 63 = 64 个文件
- 2025-夏季: 1 + 63 = 64 个文件
- **总计: 128 个 HTML 文件**

---

**版本**: 2.0 (批量版)  
**更新日期**: 2025年12月12日  
**新功能**: 批量处理多个批次  
**Python**: 3.8+  
**平台**: Windows (推荐) / macOS / Linux
