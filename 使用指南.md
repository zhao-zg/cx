# Word文档静态网站生成器 - 使用指南

## 🎉 项目已完成！

恭喜！您的Word文档静态网站生成器已经成功搭建并测试通过。

## 📁 项目结构

```
cx/
├── resource/              # Word源文档
│   ├── 听超.docx         # 听抄内容 ✓
│   ├── 经文.docx         # 经文内容 ✓
│   └── 晨兴.doc          # 晨兴内容（待处理）
├── src/                   # Python源代码
│   ├── models.py         # 数据模型 ✓
│   ├── parser.py         # Word解析器 ✓
│   ├── generator.py      # HTML生成器 ✓
│   └── templates/        # Jinja2模板 ✓
│       ├── base.html     # 基础模板
│       ├── index.html    # 首页模板
│       ├── outline.html  # 大纲页模板
│       └── details.html  # 纲目页模板
├── output/               # 生成的HTML文件 ✓
│   ├── index.html        # 首页
│   ├── 1_dg.htm ~ 9_dg.htm   # 大纲页
│   ├── 1_cv.htm ~ 9_cv.htm   # 纲目页
│   └── 1_ts.htm ~ 9_ts.htm   # 听抄页
├── .venv/                # Python虚拟环境 ✓
├── config.yaml           # 配置文件 ✓
├── main.py               # 主程序 ✓
└── README.md             # 项目说明
```

## 🚀 快速开始

### 1. 运行程序

```powershell
cd G:/project/go/cx
.venv/Scripts/python.exe main.py
```

### 2. 查看结果

打开浏览器，访问：
```
file:///G:/project/go/cx/output/index.html
```

或在VS Code中右键点击 `output/index.html` → "在浏览器中打开"

## ✅ 已实现功能

### 核心功能
- ✅ Word文档(.doc 和 .docx)解析
- ✅ 自动检测文档格式
- ✅ 多层级大纲结构提取（壹→一→1→a）
- ✅ 首页（目录页）生成
- ✅ 大纲页生成（9个篇章）
- ✅ 纲目页生成（完整内容）
- ✅ 听抄页生成
- ✅ 晨兴页生成
- ✅ 响应式设计（移动端优先）
- ✅ 清晰的层级展示

### 技术特性
- ✅ 自动识别文档样式
- ✅ 递归解析多层级结构
- ✅ Jinja2模板渲染
- ✅ YAML配置管理
- ✅ 清晰的日志输出

## 📊 生成统计

当前生成：
- **1个首页**
- **27个内容页** (9篇 × 3种类型)
  - 9个大纲页 (_dg.htm)
  - 9个纲目页 (_cv.htm)
  - 9个听抄页 (_ts.htm)

成功解析的章节：
1. 第1篇：灵里贫穷者以及清心者之福 (5个大点)
2. 第2篇：哀恸者之福，温柔者之福 (3个大点)
3. 第3篇：对于国度生活紧要的祷告 (4个大点)
4. 第4篇：怜悯人的人有福了 (5个大点)
5. 第5篇：国度子民有个人祷告的经历 (4个大点)
6. 第6篇：要完全，像我们的天父完全一样 (3个大点)
7. 第7篇：进窄门并走那引到生命的狭路 (4个大点)
8. 第8篇：先寻求神的国和祂的义 (2个大点)
9. 第9篇：实行父的旨意 (2个大点)

## 🎨 自定义修改

### 修改标题和配置

编辑 `config.yaml`：
```yaml
title: "你的训练标题"
subtitle: "你的副标题"
year: 2025
season: "秋季"

# 文档路径 (支持 .doc 和 .docx 两种格式,会自动检测)
listen_doc: "resource/听抄.docx"
scripture_doc: "resource/经文.docx"
morning_revival_doc: "resource/晨兴.doc"
```

**文档格式说明**:
- 支持 `.doc` 和 `.docx` 两种格式
- 可以混合使用不同格式
- 程序会自动检测并使用正确的解析方法
- 详见 `文档格式支持说明.md`
season: "春季"
```

### 修改样式

编辑 `src/templates/base.html` 中的 `<style>` 部分：
- 字体：修改 `font-family`
- 颜色：修改 `color` 和 `background-color`
- 布局：修改 `.container` 的 `max-width` 和 `padding`

### 添加新页面类型

1. 在 `src/templates/` 创建新模板
2. 在 `src/generator.py` 添加生成函数
3. 在 `HTMLGenerator.generate_chapter_pages()` 中调用

## 🔧 常见问题

### Q1: 如何处理 .doc 格式的文档？

A: 需要将 .doc 转换为 .docx 格式：
- 用Microsoft Word打开 → 另存为 → 选择 .docx 格式
- 或使用在线转换工具

### Q2: 如何添加更多篇章？

A: 只需确保Word文档中有正确的样式标记：
- `121文章篇题` - 篇章标题
- `131文章大点` - 大点
- `132文章中点` - 中点
- 等等

程序会自动识别并生成相应页面。

### Q3: 如何修改页面链接？

A: 编辑 `src/templates/index.html` 中的链接部分：
```html
<a href="{{ chapter.number }}_dg.htm">大纲</a>
```

### Q4: 生成失败怎么办？

A: 检查以下几点：
1. Word文档是否存在
2. 文档格式是否正确（.docx）
3. 是否有正确的样式标记
4. 查看错误信息中的具体提示

## 📈 未来扩展方向

以下是一些可能的改进方向：

### 功能扩展
- [ ] 添加晨兴页面生成（按周划分）
- [ ] 添加经文页面（独立展示）
- [ ] 添加搜索功能
- [ ] 添加打印友好样式
- [ ] 支持导出PDF

### 技术优化
- [ ] 添加单元测试
- [ ] 优化解析性能
- [ ] 添加进度条显示
- [ ] 支持增量更新
- [ ] 添加配置验证

### UI/UX改进
- [ ] 添加目录导航
- [ ] 添加返回顶部按钮
- [ ] 添加夜间模式
- [ ] 优化移动端体验
- [ ] 添加书签功能

## 💡 技术细节

### Word样式映射
```python
'121文章篇题': 'chapter_title'    # 篇章标题
'131文章大点': 'section_level1'   # 壹贰叁
'132文章中点': 'section_level2'   # 一二三
'133文章小点': 'section_level3'   # 1 2 3
'134文章小a点': 'section_level4'  # a b c
'8888文章正文': 'content'         # 正文
```

### 数据流程
```
Word文档 → Parser → TrainingData模型 → Generator → HTML文件
```

### 依赖包
```
python-docx==1.2.0  # Word文档解析
jinja2==3.1.6       # HTML模板引擎
pyyaml==6.0.3       # YAML配置解析
```

## 📞 维护说明

### 定期维护
1. 检查依赖包更新
2. 备份配置文件
3. 清理旧的output文件

### 版本控制建议
```bash
# 忽略以下文件/目录
.venv/
output/
__pycache__/
*.pyc
```

## 🎓 学习资源

如果想深入学习相关技术：
- [python-docx 文档](https://python-docx.readthedocs.io/)
- [Jinja2 文档](https://jinja.palletsprojects.com/)
- [PyYAML 文档](https://pyyaml.org/)

## 🌟 总结

这个项目成功实现了从Word文档到静态网站的自动化转换，具有以下优势：

1. **自动化** - 一键生成所有页面
2. **可扩展** - 模块化设计，易于添加新功能
3. **可维护** - 清晰的代码结构和注释
4. **灵活性** - 通过配置文件和模板轻松定制

祝使用愉快！ 🎉
