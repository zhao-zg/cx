{% extends "base.html" %}

{% block title %}æ ‡è¯­è¯—æ­Œ - {{ training.title }}{% endblock %}

{% block head_css %}
<style>
/* æ ‡è¯­è¯—æ­Œé¡µå…³é”®CSS */
.song-page{padding:0}
.song-page .page-navigation{margin-bottom:12px}
.song-container{background:var(--surface);border-radius:12px;overflow:hidden;padding:20px}
.song-image-wrapper{text-align:center;padding:0}
.song-image{max-width:100%;height:auto;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1);cursor:pointer;transition:transform 0.2s,box-shadow 0.2s}
.song-image:hover{transform:scale(1.02);box-shadow:0 6px 16px rgba(0,0,0,0.15)}
.song-image:active{transform:scale(0.98)}
.click-hint{margin-top:12px;font-size:13px;color:#999;text-align:center}
</style>
{% endblock %}

{% block content %}
<div class="song-page">
    <!-- æ ‡è¯­è¯—æ­Œé¡µå¯¼èˆªæ  -->
    <div class="page-navigation">
        <a href="../index.html" class="nav-link" title="è¿”å›žä¸»é¡µ" onclick="try{sessionStorage.setItem('cx_user_back','true')}catch(e){}">è¿”å›žä¸»é¡µ</a>
        <a href="index.html" class="nav-link" title="ç›®å½•">ç›®å½•</a>
        {% if training.mottos %}
        <a href="motto.html" class="nav-link" title="æ ‡è¯­">æ ‡è¯­</a>
        {% endif %}
        <a href="motto_song.html" class="nav-link active" title="æ ‡è¯­è¯—æ­Œ">æ ‡è¯­è¯—æ­Œ</a>
    </div>
    
    <div class="song-container">
        <div class="song-image-wrapper">
            <img src="{{ training.motto_song_image }}" alt="æ ‡è¯­è¯—æ­Œ" class="song-image" onclick="openImageViewer(this.src)">
            <p class="click-hint">ðŸ‘† ç‚¹å‡»å›¾ç‰‡æ”¾å¤§æŸ¥çœ‹</p>
        </div>
    </div>
</div>

<style>
/* å›¾ç‰‡æŸ¥çœ‹å™¨ */
.image-viewer-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);z-index:9999;animation:fadeIn 0.2s;overflow:auto}
.image-viewer-overlay.show{display:block}
.image-viewer-content{width:100%;min-height:100vh;display:flex;align-items:flex-start;justify-content:center}
.image-viewer-content img{width:100%;max-width:100vw;height:auto;display:block}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}

@media(min-width:768px){
    .song-container{padding:30px}
    .song-image{width:auto}
    .click-hint{font-size:14px;margin-top:15px}
}
</style>

{% block nav_init %}
<script>
// æ ‡è¯­è¯—æ­Œé¡µè¦†ç›– base.html çš„é»˜è®¤å¯¼èˆª
if (window.CXNavStack) {
    window.CXNavStack.initMottoSongPage();
}
</script>
{% endblock %}

{% endblock %}

{% block extra_scripts %}
<!-- å›¾ç‰‡æŸ¥çœ‹å™¨ -->
<div id="imageViewer" class="image-viewer-overlay" onclick="closeImageViewer(event)">
    <div class="image-viewer-content">
        <img id="viewerImage" src="" alt="æ ‡è¯­è¯—æ­Œ">
    </div>
</div>

<script>
function openImageViewer(src) {
    const viewer = document.getElementById('imageViewer');
    const img = document.getElementById('viewerImage');
    img.src = src;
    viewer.classList.add('show');
    document.body.style.overflow = 'hidden';
}

function closeImageViewer(event) {
    const viewer = document.getElementById('imageViewer');
    viewer.classList.remove('show');
    document.body.style.overflow = '';
}

// ESC é”®å…³é—­
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const viewer = document.getElementById('imageViewer');
        if (viewer.classList.contains('show')) {
            viewer.classList.remove('show');
            document.body.style.overflow = '';
        }
    }
});
</script>
{% endblock %}
