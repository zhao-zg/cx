{% extends "base.html" %}

{% block title %}{{ training.title }}{% endblock %}

{% block head_css %}
<style>
/* 目录页关键CSS - 放head避免FOUC */
.toc-list{display:flex;flex-direction:column;gap:1px;background:#e8ecf0;border-radius:12px;overflow:hidden;margin-bottom:20px}
.toc-item{display:flex;align-items:baseline;gap:12px;padding:14px 16px;background:var(--surface);text-decoration:none;color:inherit;transition:background-color .2s}
.toc-num{flex-shrink:0;font-size:1em;font-weight:600;color:var(--brand);white-space:nowrap}
.toc-title{flex:1;font-size:1.05em;line-height:1.6;color:#2d3748;font-weight:500}
</style>
{% endblock %}

{% block content %}
<div class="index-page">
    <!-- 目录页导航栏 -->
    <div class="page-navigation">
        <a href="../index.html" class="nav-link" title="返回主页" onclick="try{sessionStorage.setItem('cx_user_back','true')}catch(e){}">返回主页</a>
        <a href="index.html" class="nav-link active" title="目录">目录</a>
        {% if training.mottos %}
        <a href="motto.htm" class="nav-link" title="标语">标语</a>
        {% endif %}
        {% if training.motto_song_image %}
        <a href="motto_song.htm" class="nav-link" title="标语诗歌">标语诗歌</a>
        {% endif %}
    </div>
    
    <!-- 章节列表 -->
    <div class="toc-list">
        {% for chapter in training.chapters %}
        <a href="{{ chapter.number }}_cx.htm" class="toc-item" data-chapter="{{ chapter.number }}">
            <span class="toc-num">第{{ chapter.number }}篇</span>
            <span class="toc-title">{{ chapter.title }}</span>
        </a>
        {% endfor %}
    </div>
</div>

<style>
.index-page{padding:0}
.index-page .page-navigation{margin-bottom:12px}
.toc-item:active{background:var(--nav-hover)}
@media(min-width:768px){.toc-item{padding:16px 20px;gap:14px}.toc-item:hover{background:var(--nav-hover)}.toc-num{font-size:1em}.toc-title{font-size:1.0625em}}
</style>

{% block nav_init %}
<script>
// 目录页覆盖 base.html 的默认导航
if (window.CXNavStack) {
    window.CXNavStack.initDirectoryPage();
}
</script>
{% endblock %}

<script src="js/toc-redirect.js" defer></script>
{% endblock %}
