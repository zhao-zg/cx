# Wordæ–‡æ¡£é™æ€ç½‘ç«™ç”Ÿæˆå™¨ - é¡¹ç›®ç†è§£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºå®—æ•™è®­ç»ƒè¯¾ç¨‹çš„**Wordæ–‡æ¡£åˆ°é™æ€HTMLç½‘ç«™çš„è‡ªåŠ¨åŒ–è½¬æ¢å·¥å…·**ã€‚å®ƒèƒ½å¤Ÿä»å¤šä¸ªWordæ–‡æ¡£ä¸­æå–ç»“æ„åŒ–å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„ã€å¯æµè§ˆçš„é™æ€ç½‘ç«™ã€‚

**æ ¸å¿ƒä»·å€¼ï¼š** å°†å¤æ‚çš„Wordæ–‡æ¡£ï¼ˆåŒ…å«å¤šå±‚çº§å¤§çº²ã€ç»æ–‡å¼•ç”¨ã€æ™¨å…´å†…å®¹ç­‰ï¼‰è‡ªåŠ¨è½¬æ¢ä¸ºç»“æ„æ¸…æ™°ã€æ˜“äºæµè§ˆçš„ç½‘é¡µã€‚

---

## ğŸ¯ é¡¹ç›®ç›®æ ‡

**è¾“å…¥ï¼š** 3ä¸ªWordæ–‡æ¡£
- `å¬æŠ„.docx` - è¯¦ç»†çš„æ•™å¯¼å†…å®¹å’ŒèŒäº‹ä¿¡æ¯
- `ç»æ–‡.docx` - å¤§çº²ç»“æ„ã€ç»æ–‡å¼•ç”¨ã€èŒäº‹ä¿¡æ¯æ‘˜å½•
- `æ™¨å…´.doc` - æ¯å‘¨æ™¨å…´å†…å®¹ï¼ˆå‘¨ä¸€åˆ°å‘¨å…­ï¼‰

**è¾“å‡ºï¼š** å®Œæ•´çš„é™æ€HTMLç½‘ç«™
- 1ä¸ªé¦–é¡µï¼ˆç›®å½•ï¼‰
- æ¯ç¯‡ç”Ÿæˆ7ç§é¡µé¢ç±»å‹ï¼ˆå…±9ç¯‡ Ã— 7 = 63ä¸ªé¡µé¢ï¼‰

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### ä¸‰å±‚æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. è§£æå±‚ (Parser)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç»æ–‡.docx    â”‚  â”‚ å¬æŠ„.docx    â”‚  â”‚ æ™¨å…´.doc     â”‚  â”‚
â”‚  â”‚ (çº²ç›®ç»“æ„)   â”‚  â”‚ (è¯¦ç»†å†…å®¹)   â”‚  â”‚ (æ™¨å…´å†…å®¹)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                  â”‚                  â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                            â†“                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   2. æ•°æ®æ¨¡å‹å±‚ (Models)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ TrainingData (è®­ç»ƒæ•°æ®æ€»é›†)                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ Chapter 1 (ç¬¬ä¸€ç¯‡)                           â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ outline_sections (çº²ç›®ç»“æ„)             â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ detail_sections (è¯¦ç»†å†…å®¹)              â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ message_content (èŒäº‹ä¿¡æ¯)              â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ morning_revivals (æ™¨å…´å†…å®¹)             â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ scripture, hymn_number...               â”‚  â”‚
â”‚  â”‚  â”œâ”€ Chapter 2...                                 â”‚  â”‚
â”‚  â”‚  â””â”€ Chapter 9                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  3. ç”Ÿæˆå±‚ (Generator)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Jinja2æ¨¡æ¿   â”‚  â”‚ HTMLç”Ÿæˆå™¨   â”‚  â”‚ é™æ€æ–‡ä»¶     â”‚  â”‚
â”‚  â”‚ (10ä¸ªæ¨¡æ¿)   â”‚â†’ â”‚ (æ¸²æŸ“å¼•æ“)   â”‚â†’ â”‚ (64ä¸ªHTML)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç»“æ„è¯¦è§£

```
cx/
â”œâ”€â”€ ğŸ“‚ resource/              # æºæ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ å¬æŠ„.docx            # è¯¦ç»†å†…å®¹ + èŒäº‹ä¿¡æ¯
â”‚   â”œâ”€â”€ ç»æ–‡.docx            # çº²ç›®ç»“æ„ + ç»æ–‡ + èŒäº‹æ‘˜å½•
â”‚   â””â”€â”€ æ™¨å…´.doc             # æ™¨å…´å†…å®¹ï¼ˆå‘¨ä¸€~å‘¨å…­ï¼‰
â”‚
â”œâ”€â”€ ğŸ“‚ src/                   # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ models.py            # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”‚   â”œâ”€ Content          # å†…å®¹èŠ‚ç‚¹ï¼ˆæ”¯æŒé€’å½’åµŒå¥—ï¼‰
â”‚   â”‚   â”œâ”€ Chapter          # ç¯‡ç« ï¼ˆåŒ…å«å¤šç§æ•°æ®ï¼‰
â”‚   â”‚   â”œâ”€ MorningRevival   # æ™¨å…´å†…å®¹
â”‚   â”‚   â””â”€ TrainingData     # è®­ç»ƒæ•°æ®æ€»é›†
â”‚   â”‚
â”‚   â”œâ”€â”€ parser_improved.py   # æ”¹è¿›çš„è§£æå™¨ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”œâ”€ parse_outline_doc()        # è§£æç»æ–‡.docx
â”‚   â”‚   â”œâ”€ parse_listen_doc()         # è§£æå¬æŠ„.docx
â”‚   â”‚   â””â”€ parse_morning_revival_doc() # è§£ææ™¨å…´.doc
â”‚   â”‚
â”‚   â”œâ”€â”€ generator.py         # HTMLç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€ generate_index()           # ç”Ÿæˆé¦–é¡µ
â”‚   â”‚   â”œâ”€ generate_chapter_pages()   # ç”Ÿæˆç¯‡ç« é¡µé¢
â”‚   â”‚   â””â”€ _generate_*_page()         # ç”Ÿæˆå„ç±»é¡µé¢
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ templates/        # Jinja2æ¨¡æ¿ç›®å½•
â”‚       â”œâ”€â”€ base.html        # åŸºç¡€æ¨¡æ¿ï¼ˆå¸ƒå±€+æ ·å¼ï¼‰
â”‚       â”œâ”€â”€ index.html       # é¦–é¡µæ¨¡æ¿
â”‚       â”œâ”€â”€ outline.html     # çº²ç›®é¡µæ¨¡æ¿
â”‚       â”œâ”€â”€ details.html     # è¯¦æƒ…é¡µæ¨¡æ¿
â”‚       â”œâ”€â”€ scripture.html   # ç»æ–‡é¡µæ¨¡æ¿
â”‚       â”œâ”€â”€ hymn.html        # è¯—æ­Œé¡µæ¨¡æ¿
â”‚       â”œâ”€â”€ morning_revival.html  # æ™¨å…´é¡µæ¨¡æ¿
â”‚       â”œâ”€â”€ ministry.html    # èŒäº‹ä¿¡æ¯æ‘˜å½•æ¨¡æ¿
â”‚       â”œâ”€â”€ message.html     # å¬æŠ„é¡µæ¨¡æ¿
â”‚       â””â”€â”€ summary.html     # æ€»ç»“é¡µæ¨¡æ¿
â”‚
â”œâ”€â”€ ğŸ“‚ output/               # ç”Ÿæˆçš„HTMLæ–‡ä»¶
â”‚   â”œâ”€â”€ index.html          # é¦–é¡µ
â”‚   â”œâ”€â”€ 1_dg.htm            # ç¬¬1ç¯‡å¤§çº²
â”‚   â”œâ”€â”€ 1_cv.htm            # ç¬¬1ç¯‡çº²ç›®
â”‚   â”œâ”€â”€ 1_jw.htm            # ç¬¬1ç¯‡ç»æ–‡
â”‚   â”œâ”€â”€ 1_sg.htm            # ç¬¬1ç¯‡è¯—æ­Œ
â”‚   â”œâ”€â”€ 1_cx.htm            # ç¬¬1ç¯‡æ™¨å…´
â”‚   â”œâ”€â”€ 1_zs.htm            # ç¬¬1ç¯‡èŒäº‹ä¿¡æ¯æ‘˜å½•
â”‚   â”œâ”€â”€ 1_ts.htm            # ç¬¬1ç¯‡è¯¦æƒ…
â”‚   â”œâ”€â”€ 1_h.htm             # ç¬¬1ç¯‡å¬æŠ„
â”‚   â””â”€â”€ ... (2-9ç¯‡ç±»ä¼¼)
â”‚
â”œâ”€â”€ config.yaml             # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ run.bat                 # Windowsæ‰¹å¤„ç†å¯åŠ¨è„šæœ¬
â”œâ”€â”€ run.ps1                 # PowerShellå¯åŠ¨è„šæœ¬
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

---

## ğŸ” æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. æ•°æ®æ¨¡å‹ (models.py)

#### Content - å†…å®¹èŠ‚ç‚¹
```python
@dataclass
class Content:
    level: str              # å±‚çº§æ ‡è¯†ï¼šå£¹ã€ä¸€ã€1ã€a
    title: str              # æ ‡é¢˜æ–‡æœ¬
    scripture: str          # ç»æ–‡å¼•ç”¨
    content: List[str]      # æ­£æ–‡æ®µè½
    children: List[Content] # å­èŠ‚ç‚¹ï¼ˆé€’å½’ç»“æ„ï¼‰
```

**ç‰¹ç‚¹ï¼š** æ”¯æŒä»»æ„æ·±åº¦çš„å±‚çº§åµŒå¥—ï¼ˆå£¹ â†’ ä¸€ â†’ 1 â†’ aï¼‰

#### Chapter - ç¯‡ç« 
```python
@dataclass
class Chapter:
    number: int                          # ç¯‡ç« ç¼–å· 1-9
    title: str                           # æ ‡é¢˜
    outline_sections: List[Content]      # çº²ç›®ç»“æ„ï¼ˆä»…æ ‡é¢˜ï¼‰
    detail_sections: List[Content]       # è¯¦ç»†å†…å®¹ï¼ˆå¸¦æ®µè½ï¼‰
    message_content: List[str]           # èŒäº‹ä¿¡æ¯
    morning_revivals: List[MorningRevival]  # æ™¨å…´å†…å®¹
    scripture: str                       # ç»æ–‡å¼•ç”¨
    hymn_number: str                     # è¯—æ­Œç¼–å·
    ministry_excerpt: str                # èŒäº‹ä¿¡æ¯æ‘˜å½•
```

**å…³é”®è®¾è®¡ï¼š** åˆ†ç¦»äº†`outline_sections`å’Œ`detail_sections`ï¼Œè§£å†³äº†çº²ç›®é¡µå’Œè¯¦æƒ…é¡µçš„æ•°æ®æ¥æºé—®é¢˜ã€‚

#### TrainingData - è®­ç»ƒæ•°æ®æ€»é›†
```python
@dataclass
class TrainingData:
    title: str              # æ€»é¢˜
    subtitle: str           # å‰¯æ ‡é¢˜
    year: int               # å¹´ä»½
    season: str             # å­£èŠ‚
    chapters: List[Chapter] # ç¯‡ç« åˆ—è¡¨
```

---

### 2. è§£æå™¨ (parser_improved.py)

#### è§£ææµç¨‹

```
ç¬¬ä¸€æ­¥ï¼šè§£æç»æ–‡.docx
â”œâ”€ æå–ç¯‡ç« æ ‡é¢˜
â”œâ”€ æå–å¤§çº²ç»“æ„ï¼ˆå£¹ã€ä¸€ã€1ã€aï¼‰
â”œâ”€ æå–ç»æ–‡å¼•ç”¨
â”œâ”€ æå–è¯—æ­Œç¼–å·
â””â”€ æå–èŒäº‹ä¿¡æ¯æ‘˜å½•
    â†“
ç¬¬äºŒæ­¥ï¼šè§£æå¬æŠ„.docx
â”œâ”€ åŒ¹é…å¯¹åº”ç¯‡ç« 
â”œâ”€ åˆ›å»ºè¯¦ç»†å†…å®¹ç»“æ„
â”œâ”€ å¡«å……æ­£æ–‡æ®µè½
â””â”€ æå–èŒäº‹ä¿¡æ¯å†…å®¹
    â†“
ç¬¬ä¸‰æ­¥ï¼šè§£ææ™¨å…´.doc
â”œâ”€ æŒ‰å‘¨åˆ’åˆ†ï¼ˆ1-9å‘¨ï¼‰
â”œâ”€ æŒ‰å¤©åˆ’åˆ†ï¼ˆå‘¨ä¸€~å‘¨å…­ï¼‰
â”œâ”€ æå–æ™¨å…´å–‚å…»
â”œâ”€ æå–ä¿¡æ¯é€‰è¯»
â””â”€ æå–è¯—æ­Œå›¾ç‰‡
```

#### Wordæ ·å¼æ˜ å°„

| Wordæ ·å¼ | å«ä¹‰ | å±‚çº§ |
|---------|------|------|
| 121æ–‡ç« ç¯‡é¢˜ | ç¯‡ç« æ ‡é¢˜ | - |
| 131æ–‡ç« å¤§ç‚¹ | å¤§ç‚¹ | å£¹è´°å |
| 132æ–‡ç« ä¸­ç‚¹ | ä¸­ç‚¹ | ä¸€äºŒä¸‰ |
| 133æ–‡ç« å°ç‚¹ | å°ç‚¹ | 1 2 3 |
| 134æ–‡ç« å°aç‚¹ | å°aç‚¹ | a b c |
| 8888æ–‡ç« æ­£æ–‡ | æ­£æ–‡å†…å®¹ | - |

#### å…³é”®æŠ€æœ¯ç‚¹

1. **çŠ¶æ€æœºæ¨¡å¼** - è¿½è¸ªå½“å‰è§£æå±‚çº§
2. **æ­£åˆ™è¡¨è¾¾å¼** - æå–å±‚çº§æ ‡è¯†å’Œç¯‡ç« ç¼–å·
3. **é€’å½’ç»“æ„** - å¤„ç†å¤šå±‚çº§åµŒå¥—
4. **win32com** - è¯»å–.docæ ¼å¼æ–‡æ¡£
5. **å›¾ç‰‡æå–** - ä»Wordä¸­å¯¼å‡ºè¯—æ­Œå›¾ç‰‡

---

### 3. HTMLç”Ÿæˆå™¨ (generator.py)

#### é¡µé¢ç±»å‹

| æ–‡ä»¶å | é¡µé¢ç±»å‹ | æ•°æ®æ¥æº | è¯´æ˜ |
|--------|---------|---------|------|
| index.html | é¦–é¡µ | å…¨éƒ¨ç« èŠ‚ | ç›®å½•å¯¼èˆª |
| X_dg.htm | å¤§çº²é¡µ | outline_sections | çº¯æ ‡é¢˜ï¼Œé»˜è®¤æ”¶èµ· |
| X_cv.htm | çº²ç›®é¡µ | outline_sections | çº¯æ ‡é¢˜ï¼Œé»˜è®¤å±•å¼€ |
| X_jw.htm | ç»æ–‡é¡µ | scripture_verses | ç»æ–‡æ­£æ–‡ |
| X_sg.htm | è¯—æ­Œé¡µ | hymn_number, hymn_image | è¯—æ­Œç¼–å·å’Œå›¾ç‰‡ |
| X_cx.htm | æ™¨å…´é¡µ | morning_revivals | å‘¨ä¸€~å‘¨å…­å†…å®¹ |
| X_zs.htm | èŒäº‹ä¿¡æ¯æ‘˜å½• | ministry_excerpt | æ¥è‡ªç»æ–‡.docx |
| X_ts.htm | è¯¦æƒ…é¡µ | detail_sections | è¯¦ç»†å†…å®¹ |
| X_h.htm | å¬æŠ„é¡µ | message_content | èŒäº‹ä¿¡æ¯ |

#### æ¨¡æ¿ç»§æ‰¿

```
base.html (åŸºç¡€æ¨¡æ¿)
â”œâ”€ ç»Ÿä¸€çš„å¤´éƒ¨å’Œå¯¼èˆª
â”œâ”€ ç»Ÿä¸€çš„æ ·å¼
â””â”€ ç»Ÿä¸€çš„JavaScript

æ‰€æœ‰é¡µé¢æ¨¡æ¿ç»§æ‰¿base.html
â”œâ”€ index.html
â”œâ”€ outline.html
â”œâ”€ details.html
â””â”€ ...
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### å®Œæ•´æ‰§è¡Œæµç¨‹

```
1. ç”¨æˆ·è¿è¡Œ main.py
   â†“
2. åŠ è½½ config.yaml é…ç½®
   â†“
3. æ£€æŸ¥Wordæ–‡æ¡£æ˜¯å¦å­˜åœ¨
   â†“
4. è°ƒç”¨ parse_training_docs_improved()
   â”œâ”€ è§£æç»æ–‡.docx â†’ å»ºç«‹å¤§çº²éª¨æ¶
   â”œâ”€ è§£æå¬æŠ„.docx â†’ å¡«å……è¯¦ç»†å†…å®¹
   â””â”€ è§£ææ™¨å…´.doc â†’ æ·»åŠ æ™¨å…´å†…å®¹
   â†“
5. åˆ›å»º TrainingData å¯¹è±¡
   â†“
6. è°ƒç”¨ HTMLGenerator.generate_all()
   â”œâ”€ ç”Ÿæˆé¦–é¡µ
   â””â”€ ä¸ºæ¯ç¯‡ç”Ÿæˆ7ç§é¡µé¢
   â†“
7. è¾“å‡ºåˆ° output/ ç›®å½•
   â†“
8. å®Œæˆï¼
```

### æ•°æ®æµè½¬

```
Wordæ–‡æ¡£ (åŸå§‹æ•°æ®)
    â†“
Parser (è§£æ)
    â†“
Models (ç»“æ„åŒ–æ•°æ®)
    â†“
Generator (æ¸²æŸ“)
    â†“
HTMLæ–‡ä»¶ (æœ€ç»ˆè¾“å‡º)
```

---

## ğŸ¨ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| Python | ä¸»è¦ç¼–ç¨‹è¯­è¨€ | 3.12+ |
| python-docx | è§£æ.docxæ–‡æ¡£ | 1.2.0 |
| win32com | è§£æ.docæ–‡æ¡£ | - |
| Jinja2 | HTMLæ¨¡æ¿å¼•æ“ | 3.1.6 |
| PyYAML | é…ç½®æ–‡ä»¶è§£æ | 6.0.3 |
| PIL (Pillow) | å›¾ç‰‡å¤„ç† | - |

---

## ğŸ’¡ æ ¸å¿ƒè®¾è®¡æ€æƒ³

### 1. æ•°æ®åˆ†ç¦»åŸåˆ™

**é—®é¢˜ï¼š** çº²ç›®é¡µå’Œè¯¦æƒ…é¡µå…±äº«æ•°æ®ä¼šå¯¼è‡´å†…å®¹æ··ä¹±

**è§£å†³ï¼š** 
- `outline_sections` - ä»…åŒ…å«æ ‡é¢˜ï¼ˆç”¨äºçº²ç›®é¡µï¼‰
- `detail_sections` - åŒ…å«æ ‡é¢˜+å†…å®¹ï¼ˆç”¨äºè¯¦æƒ…é¡µï¼‰

### 2. ä¸‰é˜¶æ®µè§£æ

**ä¸ºä»€ä¹ˆåˆ†ä¸‰æ­¥ï¼Ÿ**
1. ç»æ–‡.docxæä¾›ç»“æ„éª¨æ¶
2. å¬æŠ„.docxå¡«å……è¯¦ç»†å†…å®¹
3. æ™¨å…´.docè¡¥å……æ™¨å…´å†…å®¹

**å¥½å¤„ï¼š** æ¸…æ™°çš„èŒè´£åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤å’Œè°ƒè¯•

### 3. é€’å½’æ•°æ®ç»“æ„

```python
Content
â”œâ”€ children: List[Content]  # æ”¯æŒæ— é™åµŒå¥—
    â”œâ”€ children: List[Content]
        â””â”€ ...
```

**å¥½å¤„ï¼š** çµæ´»å¤„ç†ä»»æ„æ·±åº¦çš„å¤§çº²å±‚çº§

### 4. æ¨¡æ¿ç»§æ‰¿

```
base.html (å…¬å…±éƒ¨åˆ†)
    â†“
å„é¡µé¢æ¨¡æ¿ (ç‰¹å®šå†…å®¹)
```

**å¥½å¤„ï¼š** ä»£ç å¤ç”¨ï¼Œç»Ÿä¸€æ ·å¼ï¼Œæ˜“äºç»´æŠ¤

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

```bash
# æ–¹æ³•1ï¼šç›´æ¥è¿è¡ŒPythonè„šæœ¬
python main.py

# æ–¹æ³•2ï¼šä½¿ç”¨PowerShellè„šæœ¬
.\run.ps1

# æ–¹æ³•3ï¼šåŒå‡»æ‰¹å¤„ç†æ–‡ä»¶
run.bat
```

### é…ç½®ä¿®æ”¹

ç¼–è¾‘ `config.yaml`ï¼š
```yaml
title: "ä½ çš„è®­ç»ƒæ ‡é¢˜"
subtitle: "å‰¯æ ‡é¢˜"
year: 2025
season: "ç§‹å­£"
```

---

## ğŸ“Š é¡¹ç›®çŠ¶æ€

### å·²å®ŒæˆåŠŸèƒ½ âœ…

- âœ… Wordæ–‡æ¡£è§£æï¼ˆ.docxå’Œ.docï¼‰
- âœ… å¤šå±‚çº§å¤§çº²ç»“æ„æå–
- âœ… é¦–é¡µç”Ÿæˆ
- âœ… 9ç§é¡µé¢ç±»å‹ç”Ÿæˆ
- âœ… æ™¨å…´å†…å®¹è§£æ
- âœ… è¯—æ­Œå›¾ç‰‡æå–
- âœ… å“åº”å¼è®¾è®¡
- âœ… å¯æŠ˜å å†…å®¹åŒºåŸŸ

### å½“å‰è¿›åº¦

**å®Œæˆåº¦ï¼š95%**

ç”Ÿæˆæ–‡ä»¶ç»Ÿè®¡ï¼š
- 1ä¸ªé¦–é¡µ
- 63ä¸ªå†…å®¹é¡µï¼ˆ9ç¯‡ Ã— 7ç§ç±»å‹ï¼‰
- æˆåŠŸè§£æ9ä¸ªç¯‡ç« 
- æˆåŠŸæå–æ™¨å…´å†…å®¹ï¼ˆå‘¨ä¸€~å‘¨å…­ï¼‰

---

## ğŸ”§ å…³é”®ä»£ç ç‰‡æ®µ

### 1. é€’å½’è§£æå¤§çº²

```python
def _parse_outline_content(self, content_lines: List[str]) -> List[Content]:
    current_level1 = None
    current_level2 = None
    
    for text in content_lines:
        if re.match(r'^[å£¹è´°å]', text):
            current_level1 = Content(level=level, title=title)
        elif re.match(r'^[ä¸€äºŒä¸‰]', text) and current_level1:
            current_level2 = Content(level=level, title=title)
            current_level1.add_child(current_level2)
```

### 2. æ¨¡æ¿æ¸²æŸ“

```python
template = self.env.get_template('outline.html')
html = template.render(chapter=chapter, training=training)
```

### 3. çŠ¶æ€æœºè§£æ

```python
if style_type == 'section_level1':
    self.current_level1 = Content(...)
    self.current_level2 = None  # é‡ç½®ä¸‹çº§
```

---

## ğŸ¯ é¡¹ç›®äº®ç‚¹

1. **é«˜åº¦è‡ªåŠ¨åŒ–** - ä¸€é”®ç”Ÿæˆæ‰€æœ‰é¡µé¢
2. **æ•°æ®åˆ†ç¦»æ¸…æ™°** - çº²ç›®/è¯¦æƒ…/å¬æŠ„å®Œå…¨ç‹¬ç«‹
3. **æ”¯æŒå¤šæ ¼å¼** - .docxå’Œ.docéƒ½èƒ½å¤„ç†
4. **é€’å½’ç»“æ„** - æ”¯æŒä»»æ„æ·±åº¦åµŒå¥—
5. **æ¨¡æ¿åŒ–è®¾è®¡** - æ˜“äºå®šåˆ¶å’Œæ‰©å±•
6. **å®Œæ•´çš„æ–‡æ¡£** - ä»£ç æ³¨é‡Šè¯¦ç»†

---

## ğŸ“ æ€»ç»“

è¿™æ˜¯ä¸€ä¸ª**è®¾è®¡ç²¾è‰¯ã€åŠŸèƒ½å®Œæ•´**çš„æ–‡æ¡£è½¬æ¢å·¥å…·ï¼š

- **æ¶æ„æ¸…æ™°** - ä¸‰å±‚æ¶æ„ï¼ŒèŒè´£åˆ†æ˜
- **æ•°æ®å‡†ç¡®** - æ­£ç¡®åŒºåˆ†ä¸åŒæ•°æ®æ¥æº
- **åŠŸèƒ½å®Œæ•´** - æ”¯æŒ9ç§é¡µé¢ç±»å‹
- **æ˜“äºä½¿ç”¨** - ä¸€é”®è¿è¡Œï¼Œè‡ªåŠ¨ç”Ÿæˆ
- **å¯ç»´æŠ¤æ€§å¼º** - æ¨¡å—åŒ–è®¾è®¡ï¼Œä»£ç æ¸…æ™°

**é€‚ç”¨åœºæ™¯ï¼š** å®—æ•™è®­ç»ƒè¯¾ç¨‹ã€æ•™å­¦ææ–™ã€å¤šå±‚çº§æ–‡æ¡£çš„ç½‘ç«™åŒ–å±•ç¤º

**æ ¸å¿ƒä»·å€¼ï¼š** å°†å¤æ‚çš„Wordæ–‡æ¡£è‡ªåŠ¨è½¬æ¢ä¸ºç»“æ„åŒ–ã€æ˜“æµè§ˆçš„é™æ€ç½‘ç«™ï¼Œå¤§å¤§æé«˜å†…å®¹çš„å¯è®¿é—®æ€§å’Œç”¨æˆ·ä½“éªŒã€‚
