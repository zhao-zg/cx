# é¡µé¢ç±»å‹ä¿®æ­£è¯´æ˜ - 2025å¹´12æœˆ12æ—¥(ä¸‹åˆ)

## ğŸ”§ æœ€æ–°ä¿®æ­£ï¼šé¡µé¢ç±»å‹é”™ä½é—®é¢˜

### é—®é¢˜å‘ç°
ç”¨æˆ·åé¦ˆ"çº²ç›®é¡µå†…å®¹ä¸å¯¹,ä¸æ˜¯çº²ç›®ä¿¡æ¯"ã€‚å¯¹æ¯”å‚ç…§ç½‘ç«™åå‘ç°:
- **çº²ç›®é¡µ(_cv.htm)**: åº”è¯¥åªæ˜¾ç¤ºå¤§çº²æ ‡é¢˜ç»“æ„(å£¹ã€ä¸€ã€1ã€a),ä¸å«è¯¦ç»†æ®µè½
- **è¯¦æƒ…é¡µ(_dg.htm)**: åº”è¯¥æ˜¾ç¤ºå®Œæ•´çš„è¯¦ç»†å†…å®¹æ®µè½
- **å¬æŠ„é¡µ(_ts.htm)**: åº”è¯¥æ˜¾ç¤ºèŒäº‹ä¿¡æ¯å†…å®¹

ä½†å®é™…ç”Ÿæˆçš„é¡µé¢:
- âŒ çº²ç›®é¡µæ˜¾ç¤ºäº†è¯¦ç»†å†…å®¹æ®µè½
- âŒ é¡µé¢åŠŸèƒ½é”™ä½

### æ ¹æœ¬åŸå› åˆ†æ

**æ•°æ®æ¨¡å‹è®¾è®¡ç¼ºé™·ï¼š**
```python
# æ—§çš„è®¾è®¡ - æœ‰é—®é¢˜
class Chapter:
    sections: List[Content]  # åŒæ—¶ç”¨äºçº²ç›®å’Œè¯¦æƒ…é¡µ
    listen_content: List[str]
```

é—®é¢˜åœ¨äºï¼š
1. çº²ç›®é¡µå’Œè¯¦æƒ…é¡µå…±äº«åŒä¸€ä¸ª`sections`æ•°æ®ç»“æ„
2. è§£æå™¨å°†è¯¦ç»†å†…å®¹å¡«å……åˆ°sectionsä¸­
3. æ¨¡æ¿æ— æ³•åŒºåˆ†"åªæ˜¾ç¤ºæ ‡é¢˜"è¿˜æ˜¯"æ˜¾ç¤ºæ ‡é¢˜+å†…å®¹"

### è§£å†³æ–¹æ¡ˆ

#### 1. æ•°æ®æ¨¡å‹é‡æ„

```python
# æ–°çš„è®¾è®¡ - åˆ†ç¦»ç»“æ„
class Chapter:
    outline_sections: List[Content]  # çº¯æ ‡é¢˜(ç»æ–‡.docx)
    detail_sections: List[Content]   # æ ‡é¢˜+å†…å®¹(å¬è¶….docx)
    message_content: List[str]       # èŒäº‹ä¿¡æ¯(å¬è¶….docxæœ«å°¾)
```

**å…³é”®æ”¹è¿›ï¼š**
- `outline_sections`: åªåŒ…å«æ ‡é¢˜å±‚çº§,æ— contentå­—æ®µ
- `detail_sections`: åŒ…å«æ ‡é¢˜+è¯¦ç»†å†…å®¹æ®µè½
- `message_content`: ç‹¬ç«‹å­˜å‚¨èŒäº‹ä¿¡æ¯

#### 2. è§£æå™¨æ”¹è¿›

**parse_outline_doc() - è§£æç»æ–‡.docx**
```python
# åˆ›å»ºçº¯æ ‡é¢˜èŠ‚ç‚¹
self.current_level1 = Content(level=level, title=text)
self.current_chapter.add_outline_section(self.current_level1)
# ä¸æ·»åŠ ä»»ä½•content
```

**parse_listen_doc() - è§£æå¬è¶….docx**
```python
# åˆ›å»ºæ–°çš„èŠ‚ç‚¹(è€Œéå¡«å……ç°æœ‰èŠ‚ç‚¹)
self.current_level1 = Content(level=level, title=text)
self.current_chapter.add_detail_section(self.current_level1)

# æ·»åŠ è¯¦ç»†å†…å®¹
if style_type == 'content':
    if self.current_level3:
        self.current_level3.add_content(text)
    elif self.current_level2:
        self.current_level2.add_content(text)
    elif self.current_level1:
        self.current_level1.add_content(text)
    elif self.current_chapter:
        # èŒäº‹ä¿¡æ¯å†…å®¹
        self.current_chapter.message_content.append(text)
```

#### 3. æ¨¡æ¿æ›´æ–°

**outline.html (çº²ç›®é¡µ)**
```html
{% for section in chapter.outline_sections %}
    <div class="section-level1">
        {{ section.level }}ã€€{{ section.title }}
    </div>
    <!-- åªæ˜¾ç¤ºæ ‡é¢˜,é€’å½’æ˜¾ç¤ºå­æ ‡é¢˜ -->
{% endfor %}
```

**details.html (è¯¦æƒ…é¡µ)**
```html
{% for section in chapter.detail_sections %}
    <div class="section-level1">
        {{ section.level }}ã€€{{ section.title }}
    </div>
    <!-- æ˜¾ç¤ºå†…å®¹æ®µè½ -->
    {% for para in section.content %}
    <div class="content-text">{{ para }}</div>
    {% endfor %}
{% endfor %}
```

**message.html (å¬æŠ„é¡µ - æ–°å¢)**
```html
{% for para in chapter.message_content %}
<p class="message-text">{{ para }}</p>
{% endfor %}
```

#### 4. ç”Ÿæˆå™¨è°ƒæ•´

```python
# é‡æ–°å‘½åå’Œè°ƒæ•´æ–¹æ³•
def _generate_outline_page():  # _cv.htm - çº²ç›®é¡µ
    template = 'outline.html'
    
def _generate_details_page():  # _dg.htm - è¯¦æƒ…é¡µ
    template = 'details.html'
    
def _generate_message_page():  # _ts.htm - å¬æŠ„é¡µ
    template = 'message.html'
```

### éªŒè¯ç»“æœ

**çº²ç›®é¡µ (1_cv.htm) âœ…**
```
å£¹ã€€"çµé‡Œè´«ç©·çš„äººæœ‰ç¦äº†ï¼Œå› ä¸ºè¯¸å¤©çš„å›½æ˜¯ä»–ä»¬çš„"
  ä¸€ã€€çµé‡Œè´«ç©·ä¸ä»…æ˜¯æŒ‡è°¦å‘...
  äºŒã€€æˆ‘ä»¬äººçš„çµé‡Œå¿…é¡»æ˜¯è´«ç©·çš„...
  ä¸‰ã€€çµé‡Œè´«ç©·ï¼Œæ„æ€å°±æ˜¯æˆ‘ä»¬æ˜¯è°¦å‘çš„...
    1ã€€çµé‡Œè´«ç©·çš„äººå¯¹ä¸»çš„äº‹å’Œå¬ä¼šçš„äº‹æœ‰ä¹æ„çš„çµ
    2ã€€çµé‡Œè´«ç©·çš„äººç»å†å–œä¹çš„çµ...
```
â†’ **åªæœ‰æ ‡é¢˜,æ— è¯¦ç»†æ®µè½** âœ“

**è¯¦æƒ…é¡µ (1_dg.htm) âœ…**
```
å£¹ã€€"çµé‡Œè´«ç©·çš„äººæœ‰ç¦äº†..."
ç¬¬ä¸€ä»¶äº‹ï¼Œåœ¨è¿™ä¸ªå›½åº¦çš„å®ªæ³•é‡Œï¼Œç¬¬ä¸€ç‚¹æ˜¯è¯´åˆ°æˆ‘ä»¬çµçš„å…‰æ™¯...
ï¼ˆå®Œæ•´çš„è¯¦ç»†å†…å®¹æ®µè½ï¼‰
```
â†’ **æœ‰æ ‡é¢˜ä¹Ÿæœ‰è¯¦ç»†è¯´æ˜** âœ“

**å¬æŠ„é¡µ (1_ts.htm) âœ…**
```
å¼Ÿå…„ä»¬æ—©å®‰ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå®Œå…¨æ˜¯å€šé ä¸»...
ï¼ˆå®Œæ•´çš„èŒäº‹ä¿¡æ¯å†…å®¹ï¼‰
```
â†’ **çº¯æ–‡æœ¬æ®µè½** âœ“

### æŠ€æœ¯è¦ç‚¹

1. **æ•°æ®ç‹¬ç«‹æ€§**: ä¸‰ç§é¡µé¢ä½¿ç”¨å®Œå…¨ç‹¬ç«‹çš„æ•°æ®æº
2. **è§£æç‹¬ç«‹æ€§**: ç»æ–‡.docxå’Œå¬è¶….docxåˆ†åˆ«è§£æ,ä¸äº’ç›¸å¹²æ‰°
3. **æ¨¡æ¿ç‹¬ç«‹æ€§**: ä¸‰ä¸ªæ¨¡æ¿ä½¿ç”¨ä¸åŒçš„å­—æ®µå’Œæ¸²æŸ“é€»è¾‘
4. **å¯ç»´æŠ¤æ€§**: æ¸…æ™°çš„èŒè´£åˆ†ç¦»,ä¾¿äºåç»­ä¿®æ”¹

### æ–‡ä»¶å˜æ›´æ¸…å•

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `src/models.py`: é‡æ„Chapterç±»,åˆ†ç¦»ä¸‰ç§æ•°æ®
- `src/parser_improved.py`: æ”¹è¿›ä¸¤ä¸ªè§£ææ–¹æ³•,åˆ›å»ºç‹¬ç«‹ç»“æ„
- `src/generator.py`: é‡å‘½åæ–¹æ³•,æ˜ç¡®ä¸‰ç§é¡µé¢ç”¨é€”
- `src/templates/outline.html`: åªæ˜¾ç¤ºæ ‡é¢˜ç»“æ„
- `src/templates/details.html`: æ˜¾ç¤ºæ ‡é¢˜+å†…å®¹
- `main.py`: æ›´æ–°è¾“å‡ºä¿¡æ¯

**æ–°å¢çš„æ–‡ä»¶ï¼š**
- `src/templates/message.html`: èŒäº‹ä¿¡æ¯é¡µæ¨¡æ¿

### è¿è¡Œç»“æœ

```
âœ“ æˆåŠŸè§£æ 9 ä¸ªç¯‡ç« 
  ç¬¬1ç¯‡: ... (çº²ç›®5ä¸ªå¤§ç‚¹, è¯¦æƒ…5ä¸ªå¤§ç‚¹)
  ç¬¬2ç¯‡: ... (çº²ç›®3ä¸ªå¤§ç‚¹, è¯¦æƒ…3ä¸ªå¤§ç‚¹)
  ...
âœ“ ç”Ÿæˆç¬¬1ç¯‡çº²ç›®: 1_cv.htm
âœ“ ç”Ÿæˆç¬¬1ç¯‡è¯¦æƒ…: 1_dg.htm
âœ“ ç”Ÿæˆç¬¬1ç¯‡å¬æŠ„: 1_ts.htm
```

### ä¸‹ä¸€æ­¥å·¥ä½œ

ç°åœ¨é¡µé¢ç±»å‹å·²ç»æ­£ç¡®:
- âœ… çº²ç›®é¡µ - çº¯æ ‡é¢˜ç»“æ„
- âœ… è¯¦æƒ…é¡µ - è¯¦ç»†å†…å®¹
- âœ… å¬æŠ„é¡µ - èŒäº‹ä¿¡æ¯
- â³ æ™¨å…´é¡µ - å¾…å®ç°(éœ€è¦è§£ææ™¨å…´.doc)
