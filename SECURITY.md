# åº”ç”¨å®‰å…¨åŠ å›ºè¯´æ˜

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•ä½¿ç”¨æ–°å¢çš„å®‰å…¨åŠŸèƒ½æ¥ä¿æŠ¤æ‚¨çš„åº”ç”¨ã€‚

## ğŸ” å·²å®æ–½çš„å®‰å…¨æªæ–½

### 1. âœ… å…³é—­è°ƒè¯•æ¨¡å¼

**ä¿®æ”¹æ–‡ä»¶**: `capacitor.config.json`

```json
{
  "android": {
    "webContentsDebuggingEnabled": false,  // å·²å…³é—­
    "allowMixedContent": true
  }
}
```

**è¯´æ˜**: 
- ç”Ÿäº§ç‰ˆæœ¬å·²ç¦ç”¨ Chrome DevTools è¿œç¨‹è°ƒè¯•
- é˜²æ­¢é€šè¿‡ `chrome://inspect` æŸ¥çœ‹åº”ç”¨å†…å®¹

---

### 2. âœ… JavaScript ä»£ç æ··æ·†

**å·¥å…·**: `javascript-obfuscator`

**å·²åˆ›å»ºæ–‡ä»¶**: 
- `obfuscate.py` - ç‹¬ç«‹æ··æ·†è„šæœ¬
- `build_secure.py` - é›†æˆå®‰å…¨æ„å»ºè„šæœ¬

**æ··æ·†ç‰¹æ€§**:
- âœ“ å˜é‡åæ··æ·†ï¼ˆè½¬ä¸ºåå…­è¿›åˆ¶ï¼‰
- âœ“ å­—ç¬¦ä¸²æ•°ç»„ç¼–ç ï¼ˆBase64ï¼‰
- âœ“ æ§åˆ¶æµæ‰å¹³åŒ–ï¼ˆå¢åŠ é€†å‘éš¾åº¦ï¼‰
- âœ“ æ­»ä»£ç æ³¨å…¥ï¼ˆå¹²æ‰°åˆ†æï¼‰
- âœ“ è‡ªæˆ‘ä¿æŠ¤ï¼ˆé˜²æ­¢ä»£ç æ ¼å¼åŒ–ï¼‰
- âœ“ å¯¹è±¡é”®åè½¬æ¢

---

### 3. âœ… å†…å®¹åŠ å¯†ä¿æŠ¤

**å·²åˆ›å»ºæ–‡ä»¶**: 
- `src/crypto_utils.py` - åŠ å¯†/è§£å¯†å·¥å…·ç±»
- `output/js/decrypt.js` - å‰ç«¯è§£å¯†æ¨¡å—ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰

**ä¿æŠ¤æœºåˆ¶**:
- ä½¿ç”¨ XOR + Base64 å¯¹æ•æ„Ÿå†…å®¹åŠ å¯†
- è¿è¡Œæ—¶åŠ¨æ€è§£å¯†æ˜¾ç¤º
- é˜²è°ƒè¯•æ£€æµ‹ï¼ˆæ£€æµ‹åˆ°è°ƒè¯•å™¨è‡ªåŠ¨åˆ·æ–°ï¼‰

---

## ğŸ“¦ ä½¿ç”¨æ–¹æ³•

### å¼€å‘æ¨¡å¼ï¼ˆæ­£å¸¸æ„å»ºï¼‰

```bash
# æ™®é€šæ„å»ºï¼Œä¸æ··æ·†
python main.py

# æˆ–ä½¿ç”¨ npm
npm run build
```

### ç”Ÿäº§æ¨¡å¼ï¼ˆå®‰å…¨æ„å»ºï¼‰

```bash
# å®‰å…¨æ„å»ºï¼šè‡ªåŠ¨æ··æ·† + åŠ å¯† + ä¼˜åŒ–
python build_secure.py

# æˆ–ä½¿ç”¨ npm
npm run build:secure
```

**å®‰å…¨æ„å»ºä¼šè‡ªåŠ¨æ‰§è¡Œ**:
1. âœ“ è¿è¡Œæ­£å¸¸æ„å»º (`python main.py`)
2. âœ“ å…³é—­è°ƒè¯•æ¨¡å¼ï¼ˆä¿®æ”¹ capacitor.config.jsonï¼‰
3. âœ“ æ··æ·†æ‰€æœ‰ JS æ–‡ä»¶ï¼ˆ`output/js/*.js`ï¼‰
4. âœ“ æ·»åŠ å†…å®¹ä¿æŠ¤æ¨¡å—
5. âœ“ ä¼˜åŒ– HTMLï¼ˆç§»é™¤æ³¨é‡Šã€å‹ç¼©ç©ºç™½ï¼‰
6. âœ“ å¤‡ä»½åŸå§‹æ–‡ä»¶ï¼ˆ`output/js_original/`ï¼‰

### å®Œæ•´çš„ç”Ÿäº§æ‰“åŒ…æµç¨‹

```bash
# 1. å®‰å…¨æ„å»º
npm run build:secure

# 2. åŒæ­¥åˆ° Capacitor
npm run cap:sync

# 3. æ‰“åŒ… Android APK
cd android
./gradlew assembleRelease
cd ..

# 4. æ¢å¤å¼€å‘é…ç½®ï¼ˆé‡è¦ï¼ï¼‰
npm run restore:dev
```

æˆ–è€…ä½¿ç”¨ä¸€é”®å‘½ä»¤ï¼š

```bash
# ä¸€é”®å®‰å…¨æ‰“åŒ…
npm run android:build:secure

# è®°å¾—æ¢å¤å¼€å‘é…ç½®
npm run restore:dev
```

---

## ğŸ”§ å®‰è£…ä¾èµ–

### Python ä¾èµ–

```bash
pip install cryptography
```

### Node.js ä¾èµ–

```bash
npm install
# æˆ–æ‰‹åŠ¨å®‰è£…
npm install -D javascript-obfuscator
```

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `build_secure.py` | **ä¸»å®‰å…¨æ„å»ºè„šæœ¬**ï¼Œé›†æˆæ‰€æœ‰å®‰å…¨åŠŸèƒ½ |
| `obfuscate.py` | JS æ··æ·†å·¥å…·ï¼ˆå¯ç‹¬ç«‹ä½¿ç”¨ï¼‰ |
| `src/crypto_utils.py` | å†…å®¹åŠ å¯†å·¥å…·ç±» |
| `capacitor.config.json` | Capacitor é…ç½®ï¼ˆå·²å…³é—­è°ƒè¯•ï¼‰ |
| `package.json` | æ–°å¢ `build:secure` ç­‰è„šæœ¬ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å¤‡ä»½ç®¡ç†

å®‰å…¨æ„å»ºä¼šè‡ªåŠ¨åˆ›å»ºå¤‡ä»½ï¼š

```
capacitor.config.json.dev.backup  # å¼€å‘é…ç½®å¤‡ä»½
output/js_original/               # åŸå§‹ JS æ–‡ä»¶å¤‡ä»½
```

### 2. æ¢å¤å¼€å‘é…ç½®

**ç”Ÿäº§æ‰“åŒ…ååŠ¡å¿…æ¢å¤å¼€å‘é…ç½®**ï¼Œå¦åˆ™å½±å“æœ¬åœ°è°ƒè¯•ï¼š

```bash
python build_secure.py --restore
# æˆ–
npm run restore:dev
```

### 3. Git å¿½ç•¥

å»ºè®®æ·»åŠ åˆ° `.gitignore`ï¼š

```gitignore
# å®‰å…¨æ„å»ºå¤‡ä»½
*.dev.backup
output/js_original/
```

---

## ğŸ›¡ï¸ å®‰å…¨çº§åˆ«åˆ†æ

### å½“å‰ä¿æŠ¤ï¼ˆå·²å®æ–½ï¼‰

| æªæ–½ | é˜²æŠ¤ç­‰çº§ | è¯´æ˜ |
|------|----------|------|
| å…³é—­è°ƒè¯• | â­â­â­ | é˜»æ­¢åŸºæœ¬çš„è¿œç¨‹è°ƒè¯• |
| JS æ··æ·† | â­â­â­â­ | æ˜¾è‘—å¢åŠ é€†å‘éš¾åº¦ |
| å†…å®¹åŠ å¯† | â­â­ | é˜²æ­¢ç›´æ¥è¯»å–ï¼Œä½†å¯†é’¥åœ¨å®¢æˆ·ç«¯ |

### è¿›é˜¶ä¿æŠ¤ï¼ˆå¯é€‰ï¼‰

å¦‚éœ€æ›´é«˜å®‰å…¨æ€§ï¼Œå¯è€ƒè™‘ï¼š

1. **æœåŠ¡å™¨ç«¯æ¸²æŸ“** - å†…å®¹ä¸å­˜å‚¨åœ¨å®¢æˆ·ç«¯
2. **åŸç”Ÿä»£ç ä¿æŠ¤** - ä½¿ç”¨ ProGuard/R8 æ··æ·† Java/Kotlin ä»£ç 
3. **å®Œæ•´æ€§æ£€æŸ¥** - æ£€æµ‹ APK æ˜¯å¦è¢«ç¯¡æ”¹
4. **Root æ£€æµ‹** - åœ¨ Root è®¾å¤‡ä¸Šæ‹’ç»è¿è¡Œ

---

## ğŸ§ª æµ‹è¯•æ··æ·†æ•ˆæœ

### æµ‹è¯•å•ä¸ªæ–‡ä»¶

```bash
python obfuscate.py output/js/app-update.js
```

### æµ‹è¯•æ•´ä¸ªç›®å½•

```bash
python obfuscate.py output/js
```

### æŸ¥çœ‹æ··æ·†å‰åå¯¹æ¯”

```bash
# æ··æ·†å‰
cat output/js_original/app-update.js

# æ··æ·†å
cat output/js/app-update.js
```

---

## ğŸ“Š æ€§èƒ½å½±å“

- **JS æ··æ·†**: æ–‡ä»¶å¤§å°å¢åŠ  30-50%ï¼Œæ‰§è¡Œæ€§èƒ½ä¸‹é™ < 10%
- **å†…å®¹åŠ å¯†**: è§£å¯†æ—¶é—´ < 100msï¼Œå¯¹ç”¨æˆ·ä½“éªŒå½±å“æå°
- **æ„å»ºæ—¶é—´**: å®‰å…¨æ„å»ºæ¯”æ™®é€šæ„å»ºå¤š 1-2 åˆ†é’Ÿï¼ˆå–å†³äº JS æ–‡ä»¶æ•°é‡ï¼‰

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: æ··æ·†ååº”ç”¨æ— æ³•è¿è¡Œï¼Ÿ

A: æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ï¼Œå¯èƒ½æ˜¯æ··æ·†é…ç½®è¿‡äºæ¿€è¿›ã€‚å¯ä»¥åœ¨ `build_secure.py` ä¸­è°ƒæ•´æ··æ·†é€‰é¡¹ã€‚

### Q: å¦‚ä½•ç¦ç”¨æŸä¸ªå®‰å…¨åŠŸèƒ½ï¼Ÿ

A: ç¼–è¾‘ `build_secure.py`ï¼Œæ³¨é‡Šæ‰å¯¹åº”çš„å‡½æ•°è°ƒç”¨ã€‚

### Q: å¼€å‘æ—¶éœ€è¦ç”¨å®‰å…¨æ„å»ºå—ï¼Ÿ

A: **ä¸éœ€è¦**ã€‚å¼€å‘æ—¶ä½¿ç”¨ `npm run build` æˆ– `python main.py` å³å¯ã€‚å®‰å…¨æ„å»ºä»…ç”¨äºç”Ÿäº§æ‰“åŒ…ã€‚

---

## ğŸ“ æ›´æ–°æ—¥å¿—

**2026-02-10**
- âœ… å®æ–½äº† 3 é¡¹æ ¸å¿ƒå®‰å…¨æªæ–½
- âœ… åˆ›å»ºäº†è‡ªåŠ¨åŒ–å®‰å…¨æ„å»ºè„šæœ¬
- âœ… æ·»åŠ äº†å¼€å‘/ç”Ÿäº§é…ç½®åˆ‡æ¢æœºåˆ¶

---

## ğŸ“§ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚
