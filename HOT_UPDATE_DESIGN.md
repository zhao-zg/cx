# 热更新设计方案

## 问题分析

### 当前方案的问题
- 逐个下载 262 个文件
- 262 次 HTTP 请求
- 每次请求都有网络延迟
- 总时间 = 262 × (延迟 + 下载时间)
- **比包更新慢！**

### 理想方案
- 打包成一个 ZIP 文件
- 1 次 HTTP 请求
- 客户端解压
- **和包更新一样快！**

## 推荐方案：增量更新包

### 服务器端
1. 生成完整资源包：`hot-update-full.zip`（所有文件）
2. 生成增量包：`hot-update-v0.8.0-to-v0.8.1.zip`（只包含变化的文件）

### 客户端
1. 检查本地版本
2. 如果是首次热更新 → 下载完整包
3. 如果是增量更新 → 下载增量包
4. 解压并替换文件
5. 刷新应用

### 优势
✅ 快速：1 次 HTTP 请求
✅ 高效：只下载变化的文件（增量包）
✅ 离线：解压后完全离线
✅ 可靠：ZIP 格式成熟稳定

## 当前折中方案

由于实现完整的增量更新包需要：
- 服务器端生成 ZIP
- 客户端解压 ZIP（需要 JSZip 库）
- 文件差异对比
- 较复杂的实现

**当前采用简化方案**：
1. 只更新 4 个关键文件
2. Service Worker 按需更新其他文件
3. 快速（1-2 秒）
4. 渐进式更新

## 未来改进

如果需要更快的热更新，可以实现：
1. 服务器端打包 ZIP
2. 客户端下载并解压
3. 完整的增量更新

参考实现：
- Cordova Hot Code Push
- CodePush (React Native)
- Capacitor Live Updates
