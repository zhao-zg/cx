# 🚀 一键部署到 Cloudflare Pages

## ✨ 特点

- ✅ **完全免费**：无限带宽，全球 CDN
- ✅ **自动部署**：推送到 GitHub 自动构建
- ✅ **无需配置**：不需要 API Token 或 Secrets
- ✅ **一键操作**：使用 `deploy.bat` 即可

## 📋 首次设置（一键完成）

### 方法 1：一键设置脚本（推荐）⭐

**Windows CMD:**
```bash
setup-cloudflare.bat
```

**PowerShell:**
```powershell
.\setup-cloudflare.ps1
```

脚本会自动：
1. ✅ 检查 Git 状态
2. ✅ 推送代码到 GitHub
3. ✅ 打开 Cloudflare Pages 设置页面
4. ✅ 显示详细配置说明

然后在浏览器中按照提示完成配置即可！

### 方法 2：手动设置

#### 1️⃣ 推送代码到 GitHub

```bash
git push origin main
```

#### 2️⃣ 在 Cloudflare 连接 GitHub

1. 访问 https://dash.cloudflare.com/
2. 点击 **Workers & Pages** → **Create application**
3. 选择 **Pages** → **Connect to Git**
4. 授权并选择你的 GitHub 仓库
5. 配置构建（优化版）：
   ```
   构建命令: chmod +x install-deps.sh && ./install-deps.sh
   部署命令: chmod +x generate.sh && ./generate.sh
   输出目录: output
   环境变量:
     PYTHON_VERSION = 3.9
     DEBIAN_FRONTEND = noninteractive
   ```
6. 点击 **Save and Deploy**

**优势**：分离构建和部署命令，依赖安装会被缓存，后续构建更快！

**说明**：构建脚本会自动检测并安装 LibreOffice（用于 `.doc` 文件转换），在 Cloudflare Pages 的 Linux 环境中使用 apt 安装

#### 3️⃣ 等待部署完成 ✅

2-5 分钟后，你会得到一个网址：
```
https://你的项目名.pages.dev
```

## 🎯 日常使用 - 一键部署

### 方法 1：使用脚本（推荐）

**Windows:**
```bash
deploy.bat
```

**PowerShell:**
```powershell
.\deploy.ps1
```

脚本会自动：
1. 提示输入提交信息
2. 提交所有更改
3. 推送到 GitHub
4. **Cloudflare 自动检测并部署** 🎉

### 方法 2：手动推送

```bash
git add .
git commit -m "更新内容"
git push origin main
```

推送后，Cloudflare 会自动：
- 检测到更新
- 运行 `python main.py`
- 部署到全球 CDN

## 📊 查看部署状态

访问 https://dash.cloudflare.com/
1. 点击 **Workers & Pages**
2. 选择你的项目
3. 查看 **Deployments** 标签

状态说明：
- 🟢 绿色勾号 = 部署成功
- 🟡 黄色圆圈 = 正在部署（2-5 分钟）
- 🔴 红色叉号 = 部署失败（点击查看日志）

## 💡 优势对比

### 传统方式（GitHub Actions）
- ❌ 需要配置 API Token
- ❌ 需要设置 GitHub Secrets
- ❌ 需要编写工作流文件
- ❌ 配置复杂

### Cloudflare Pages（推荐）✨
- ✅ 直接连接 GitHub
- ✅ 无需 API Token
- ✅ 无需 Secrets
- ✅ 配置简单
- ✅ 推送即部署

## 🎁 额外功能

### 自定义域名
1. 在项目设置中添加域名
2. 配置 DNS（如果域名在 Cloudflare，自动配置）
3. 自动获得 HTTPS 证书

### 预览部署
每个分支都有独立的预览 URL：
- 主分支：`https://你的项目.pages.dev`
- 其他分支：`https://分支名.你的项目.pages.dev`

### 回滚版本
在 Deployments 中可以一键回滚到任何历史版本

## ❓ 常见问题

**Q: 部署需要多久？**
A: 通常 2-5 分钟，取决于文件数量

**Q: 可以看到构建日志吗？**
A: 可以，在 Cloudflare 项目的 Deployments 中点击查看

**Q: 本地的 output 文件夹需要提交吗？**
A: 不需要，已在 `.gitignore` 中忽略，Cloudflare 会重新生成

**Q: 如何停止自动部署？**
A: 在项目设置中可以暂停自动部署

## 📚 详细文档

- `QUICK_START.md` - 快速开始指南
- `DEPLOYMENT.md` - 详细部署文档
- `README.md` - 项目说明

## 🎉 开始使用

现在就推送代码到 GitHub，然后在 Cloudflare 连接仓库，享受一键部署的便利吧！

```bash
git push origin main
```
